# Production Environment Configuration

aws_account_id = "123456789012"
aws_region     = "us-east-1"
environment  = "prod"

# ECR Repository Configuration
ecr_repository_arns = [
  "arn:aws:ecr:us-east-1:123456789012:repository/profile-api",
  "arn:aws:ecr:us-east-1:123456789012:repository/profile-worker"
]

# ECS Cluster
enable_container_insights = "enabled"

# ECS Services - Production Configuration
ecs_services = {
  api = {
    # Required
    container_name  = "api"
    container_image = "123456789012.dkr.ecr.us-east-1.amazonaws.com/profile-api"
    container_port  = 3000
    
    # Production overrides
    container_image_tag = "v1.0.0"
    task_cpu            = "1024"
    task_memory         = "2048"
    desired_count       = 3
    launch_type         = "FARGATE" # Standard Fargate for production
    log_retention_days  = 30
    
    environment_variables = {
      NODE_ENV  = "production"
      LOG_LEVEL = "info"
    }
    
    health_check_command      = ["CMD-SHELL", "curl -f http://localhost:3000/health || exit 1"]
    health_check_grace_period = 120
  }
  
  worker = {
    container_name  = "worker"
    container_image = "123456789012.dkr.ecr.us-east-1.amazonaws.com/profile-worker"
    container_port  = 8080
    
    container_image_tag = "v1.0.0"
    task_cpu            = "512"
    task_memory         = "1024"
    desired_count       = 2
    log_retention_days  = 30
    
    environment_variables = {
      NODE_ENV = "production"
    }
  }
}

# ALB Configuration (enabled for production)
enable_alb              = true
alb_deletion_protection = true

# ALB Routing - Separate from service definitions
alb_routes = {
  api = {
    path_pattern = "/api/*"
    priority     = 100
    # Optional overrides
    # host_header = "api.example.com"
    # health_check_path = "/health"
  }
  
  worker = {
    path_pattern = "/worker/*"
    priority     = 200
  }
}
